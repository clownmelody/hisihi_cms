<!DOCTYPE html>
<html>
<head>
    <php>
        $oneplus_seo_meta = get_seo_meta($vars,$seo);
    </php>

    <if condition="$oneplus_seo_meta['title']">
        <title>{$oneplus_seo_meta['title']}</title>
        <else/>
        <title>{:C('WEB_SITE_TITLE')}</title>
    </if>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <link rel="stylesheet" href="__CSS__/app.min.css">
    <style>
        .app-bottombar {
            z-index: 3000;
            position: fixed;
            bottom: 0;
            height: 60px;
            width: 100%;
            display: none;
            background: url("__IMG__/bg.png");
        }

        .bottomspace {
            display: none;
            height: 55px;
        }
        .bottom-icon {
            float: left;
            margin: 5px 10px 5px 10px;
        }
        .bottom-title {
            float: left;
            font-size: 18px;
            color: #fff;
            margin-top: 10px;
        }
        .bottom-content {
            position: absolute;
            color: #aaa;
            font-size: 12px;
            margin-top: 4px;
        }
        .bottom-star {
            float: left;
            width: 65px;
            margin-top: 10px;
            margin-left: 5px;
        }

        .bottom-right {
            float: right;
            margin: 12px 10px;
            width: 80px;
            height: 35px;
            font-size: 16px;
            color: #fff;
            line-height: 35px;
            border-radius: 5px;
            background-color: #2aba00;
            text-align: center;
            z-index: 3000;
        }
        .info-title {
            height: 40px;
        }
        .info-time {
            font-size: 12px;
            color: #ccc;
        }
        img {
            max-width:100%;height:auto;
        }
        /*投票*/
        .bottomVoteCon{
            height: 80px;
            width: 100%;
            position: relative;
        }
        .bottomVoteCon>div{
            float: left;
        }
        .bottomVoteCon .middleBox{
            width: 100%;
        }
        .bottomVoteCon .middleBox .middle{
            margin: 0 80px;
            height: 100%;
        }
        .mainVoteBarCon{
            height: 23px;
            width: 100%;
            opacity: 0;
        }
        .mainVoteBarCon *{
            font-family: "Microsoft Yahei", "Microsoft YaHei", "黑体", "宋体", sans-serif;
        }
        .mainVoteBarCon > div{
            float: left;
            height: 100%;
            color: white;
            line-height: 23px;
        }
        .mainVoteBarCon .up{
            /*width: 58%;*/
            background-color: #FF5A00;
            box-sizing: border-box;
            padding-left: 10px;
            overflow: hidden;
        }
        .mainVoteBarCon .down{
            /*width: 20%;*/
            background-color:#039BE5;
            text-align: right;
            box-sizing: border-box;
            padding-right: 10px;
            overflow: hidden;
        }
        .mainVoteBarCon .arrowCon{
            width: 25px;
            height: 23px;
        }
        #arrowColor{
            width: 100%;
            height: 100%;
        }
        .bottomVoteCon .upAndDownNum{
            overflow: hidden;
            padding-top: 5px;
            width: 80px;
            height: 100%;
            text-align: center;
        }
        .bottomVoteCon .left{
            color: #FF5A00;
            margin-left:-100%;
        }
        .bottomVoteCon .right{
            margin-left:-80px;
            color: #039BE5;
        }

        .bottomVoteCon .title{
            position: absolute;
            left: 50%;
            padding-top: 5px;
            color: white;
        }

        .mainVoteBtnCon{
            margin-top: 12px;
            height: 27px;
            width: 100%;
        }
        .mainVoteBtnCon>div{
            float: left;
        }
        .mainVoteBtnCon .totalVoteInfo{
            width: 100%;
            text-align: center;
            height: 100%;
        }
        .totalVoteInfoMiddle {
            height: 100%;
            box-sizing: border-box;
            line-height: 27px;
            margin: 0 44px;
            color: #808080;
        }
        .mainVoteBtnCon .spriteBgBtn{
            background: url('__IMG__/topcontent/sprite.png');
            height: 48px;
            width: 88px;
            display: inline-block;
            height: 24px;
            width: 44px;
            height: 27px;
            width: 50px;
            background-size: 200px 27px;
        }
        .mainVoteBtnCon .upBtn{
            margin-left:-100%;
        }
        .mainVoteBtnCon .upBtnAble{
            background-position:-50px 0;
        }
        .mainVoteBtnCon .upBtnDisabled{
            background-position:-150px 0;
        }
        .mainVoteBtnCon .downBtn{
            margin-left:-50px;
        }
        .mainVoteBtnCon .downBtnAble{
            background-position:0 0;
        }
        .mainVoteBtnCon .downBtnDiabled{
            background-position:-100px 0;
        }
    </style>
</head>

<body>
<div class="app-page" data-page="home">
    <!--
    <div class="app-topbar">
        <div class="app-title">提问详情</div>
    </div>
    -->
    <div id="test-agent" style="display:none">user-agent</div>
    <div class="app-content" style="-webkit-box-shadow: none;">
        <div class="app-section" style="margin: 10px 10px 10px 10px">
            <div class="info-title">
                <div style="float:left;margin-top:-10px;width:100%">
                    <h2>{$top_content_info.title}</h2>
                </div>
            </div>
            <div class="info-time">
                <p>{$top_content_info.create_time|date='m-d H:i',###}</p>
            </div>
            <div style="height:2px;width: 100%; border-top: 1px #e8e9ea solid;border-radius:0px;margin-left:-8px;padding-right: 16px">
            </div>
            <div>
            <p>
                {$top_content_info.content}
                </p>
            </div>
        </div>
        <div class="bottomspace"></div>
        <div class="bottomVoteCon">
            <div class="middleBox">
                <div class="middle">
                    <div class="mainVoteBarCon">
                        <div class="up"></div>
                        <div class="arrowCon">
                            <!--width="25" height="23"-->
                            <canvas  id="arrowColor"></canvas>
                        </div>
                        <div class="down"></div>
                    </div>
                    <div class="mainVoteBtnCon">
                        <div class="totalVoteInfo">
                            <div class="totalVoteInfoMiddle">
                                <span>已经有</span>
                                <span id="totalVoteNum"></span>
                                <span>投票</span>
                            </div>
                        </div>
                        <div class="spriteBgBtn upBtn upBtnAble"></div>
                        <div class="spriteBgBtn downBtn downBtnAble"></div>
                </div>
                </div>
            </div>
            <div class="left upAndDownNum"></div>
            <div class="right upAndDownNum"></div>
            <div class="title">VS</div>
        </div>
    </div>
    <div class="app-bottombar">
        <div>
            <div>
            <span class="bottom-icon">
                <img style="width: 50px;" src="__IMG__/icon.png" />
            </span>
            <span class="bottom-title">
                <p>嘿设汇</p>
                <p class="bottom-content">设计师必备 百万设计师都在用</p>
            </span>
            <span class="bottom-star">
                <img style="width: 10px;margin-left: -1px" src="__IMG__/star.png" />
                <img style="width: 10px;margin-left: -1px;" src="__IMG__/star.png" />
                <img style="width: 10px;margin-left: -1px;" src="__IMG__/star.png" />
                <img style="width: 10px;margin-left: -1px;" src="__IMG__/star.png" />
                <img style="width: 10px;margin-left: -1px;" src="__IMG__/star.png" />
            </span>
            </div>
            <div class="app-button bottom-right">
                <p>立即下载</p>
            </div>
        </div>
    </div>
</div>

<div class="app-page" data-page="page2">
    <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title">Page 2</div>
    </div>
    <div class="app-content">
        Create By RFly！
    </div>
</div>

<script src="__JS__/zepto.js"></script>
<script src="__JS__/app.min.js"></script>
<script>
    App.controller('home', function (page) {
        // put stuff here
        //rawText      : '点击“确定”下载<br>【嘿设汇App】<br>体验更多功能',
        $(page)
            .find('.app-button')
            .on('click', function () {
                    window.location.href = "http://www.hisihi.com/download.php";
                    /*App.dialog({
                        title        : '嘿设汇',
                        rawText      : '<img style="width: 50px;" src="__IMG__/icon.png" /><br>火速下载',
                        okButton     : '确定',
                        cancelButton : '取消'
                    }, function (tryAgain) {
                        if (tryAgain) {
                            location.href = 'http://www.hisihi.com/app/downloadapp.html';
                        }
                    });*/
            });

        $(function(){

            //加载投票信息
            loadVoteInfo();

            drawArrowColorBlock();

            //绘制箭头
            function drawArrowColorBlock(){
                var canvas=document.getElementById('arrowColor');
                var ctx=canvas.getContext('2d'),
                        w=canvas.width,
                        h=canvas.height;
                var lines = ["#FF5A00", "#039BE5"];
                ctx.fillStyle = lines[0];
                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.lineTo(w, 0);
                ctx.lineTo(0, h);
                ctx.closePath();
                ctx.fill();

                ctx.fillStyle = lines[1];
                ctx.beginPath();
                ctx.moveTo(w, 0);
                ctx.lineTo(0, h);
                ctx.lineTo(w, h);
                ctx.closePath();
                ctx.fill();
            }

            /*通过点赞和 踩的 人数，控制颜色条的长度*/
            function loadVoteInfo(){
                var up=1522,down=10;
                var total=up+down,
                        percent1=Math.round(up/total*100),
                        percent2=100-percent1;
                var $voteCon=$('.bottomVoteCon'),
                        $left=$voteCon.find('.left'),
                        $right=$voteCon.find('.right');
                $left.text(up+'赞');
                $right.text(down+'踩');

                $voteCon.find('#totalVoteNum').text(total);

                //颜色条样式
                var $voteBar=$voteCon.find('.mainVoteBarCon'),
                    $up=$voteBar.find('.up'),
                    $down=$voteBar.find('.down'),
                    w=$voteBar.width()-$voteBar.find('.arrowCon').width(),
                    wUp=Math.round(w*percent1/100);
                $up.css('width',wUp);
                $down.css('width',w-wUp);
                if(w-up<10){
                    $down.css('padding-right','0');
                }
                $voteBar.css('opacity',1);
            }
        });

    });

    App.controller('page2', function (page) {
        // put stuff here
    });

    try {
        App.restore();
    } catch (err) {
        App.load('home');
    }

    $("a").removeAttr('href');

    //var userAgent = navigator.userAgent.toLowerCase();

    var userAgent = window.location.href;
    //$("#test-agent").html(userAgent);
    if(userAgent.indexOf("hisihi-app") < 0) {
        $(".app-bottombar").show();
        $(".bottomspace").show();
    }

</script>
</body>
</html>
